function IsSeatAvailable(in_id in flights.flight_id%TYPE, in_seat in seats.seat_no%TYPE) return number
is 
    v_temp number;
    v_return number;  
    v_max_seat_number number;
    v_max_seat_letter varchar(2);
begin
    select count(*) into v_temp
    from flights f, aircrafts_data a, seats s
    where f.aircraft_code=a.aircraft_code and  a.aircraft_code=s.aircraft_code 
    and in_id = flight_id and in_seat = seat_no;
    
    select max(to_number(substr(seat_no, 1,2))) into v_max_seat_number
    from flights f, aircrafts_data a, seats s
    where  f.aircraft_code=a.aircraft_code and  a.aircraft_code=s.aircraft_code  and length(seat_no) = 3 and in_id = flight_id;
    
    select max(substr(seat_no, -1)) into v_max_seat_letter
    from flights f, aircrafts_data a, seats s
    where  f.aircraft_code=a.aircraft_code and  a.aircraft_code=s.aircraft_code and in_id = flight_id;
    
    if length(in_seat) = 2 then
       if substr(in_seat, -1) > v_max_seat_letter then
            DBMS_OUTPUT.PUT_LINE('Места ' ||  in_seat || ' на рейсе ' || in_id || ' не существует.');
       else
            if v_temp > 0 then
                v_return:=0;
            else 
                v_return:=1;
            end if;
      end if;
     else if length(in_seat) = 3 then 
        if to_number(substr(in_seat, 1,2)) > v_max_seat_number and  substr(in_seat, -1) > v_max_seat_letter then 
            DBMS_OUTPUT.PUT_LINE('Места ' ||  in_seat || ' на рейсе ' || in_id || ' не существует.');
       else
            if v_temp > 0 then
                v_return:=0;
            else 
                v_return:=1;
       end if;
     end if;
      
    else 
      DBMS_OUTPUT.PUT_LINE('Места ' || in_seat || ' на рейсе ' || in_id || ' не существует.');
    end if;
    end if;
    return v_return;  
end IsSeatAvailable;
