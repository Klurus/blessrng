CREATE OR REPLACE FUNCTION IsFlightFull (no_id_flight VARCHAR2) RETURN NUMBER IS
	v_full NUMBER;
	no_aircraft_code NUMBER;
	am_of_seats NUMBER;
	am_of_passes NUMBER;
BEGIN
	SELECT aircraft_code into no_aircraft_code FROM avia.flights
	WHERE flight_id = no_id_flight

	select count(*) into am_of_seats FROM avia.seats
	WHERE aircraft_code = no_aircraft_code 

	select count(*) into am_of_passes FROM avia.boarding_passes
	WHERE flight_id = no_id_flight

	IF am_of_seats = am_of_passes THEN 
		v_full:=1;
	ELSE
		v_full:=0;
	ENDIF;
	RETURN v_full;
END IsFlightFull;

SELECT IsFlightFull(123) from dual;

SELECT count(*) from avia.flights;
WHERE flight_id<400 and IsFlightFull(flight_id)=1
